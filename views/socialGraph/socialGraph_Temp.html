<div ng-init="fbPageInit()" data-ng-controller="socialGraphCtrl">

    <!-- search fb page -->
    <div id="fbPageSearch" ng-class="{'block' : activePageSearch,'hidden' : !activePageSearch}">
        <md-content class="md-default-theme overflow-none ">
            <div class="md-content__body">
                <div class="home-mini-card">
                    <div class="row m-t-0">
                        <div class="col-md-1">
                                <span class="circle-icon md bg-primary">
                                  <md-icon class="color-white ng-isolate-scope md-default-theme
                                  fa fa-facebook fa-3x"
                                           aria-hidden="true">
                                  </md-icon>
                                </span>
                        </div>
                        <div class="col-md-5">
                            <div class="graph-main-header-text">
                                <!-- social page name-->
                                <h2 class="color-primary graph-h1">
                                    My Pages and Groups
                                </h2>
                                <md-button class="md-raised"
                                           ng-click="loginWithFb()"
                                >{{lblPageLogin}}
                                </md-button>
                            </div>
                        </div>
                        <div  class="col-md-6">
                            <!-- posts -->
                            <div class="row">
                            <md-input-container layout="column" class="col-md-6">
                                <label>Search page or group</label>
                                <input ng-enter="searchPage(searchPage.query)" ng-model="searchPage.query">
                            </md-input-container>
                             <div class="col-md-6">
                              <md-button class="md-raised" ng-click="searchPage(searchPage.query)"
                                >Search!
                                </md-button>
                                </div>
                                </div>
                               
                        </div>
                    </div>
                </div>

            </div>
        </md-content>
        <div class="fb-page-search-wrap">
            <!-- <md-card ng-show="preloader" class="md-default-theme message-card" flex>
                                        <div class="md-content__body" layout-margin>
                                            <section class="home-mini-card">
                                                <div>
                                                    <div class="col-md-8" layout="row" layout-align="center center">
                                                        <h4 ng-show="errorMessage" class=" graph-h5 color-accent error-message">
                                                           Unexpected Error Occured. Please Try Again!
                                                        </h4>
                                                        <img class="social-graph-preloader" 
                                                        ng-show="preloader && !errorMessage" src="styles/css/images/preloaders/facebook.gif" alt="Washed Out">
                                                    </div>
                                                </div>
                                            </section>
                                        </div>
            </md-card> -->
            <md-content class="md-default-theme overflow-none ">
                <div layout="column" class="md-content__body">
<!--
                    <div class="fb-pages-loading" data-ng-if="isPageLoading">
                        <md-progress-circular class="md-raised md-hue-1" md-mode="indeterminate">
                        </md-progress-circular>
                    </div>
-->
                    <md-card>
                        <md-card-content>
                            <h2 class="md-title">My Pages</h2>
                            <md-list-item class="md-3-line md-no-proxy ng-scope" data-ng-repeat="page in fbPages"
                                      role="listitem">
                                <button class="md-fab   md-button
                                    md-default-theme md-fab-md social-graph-fab" ng-click="viewPageDetails(page)"
                                         aria-label="button">
                                    <i class="ion-social-facebook-outline ion-30"></i>
                                </button>

                                <div class="md-list-item-text text-right">
                                    <h3 class="graph-h2">{{page.name}}</h3>
                                </div>
                                <!-- ngIf: !$last -->
                                <md-divider md-inset="" ng-if="!$last" class="ng-scope md-default-theme"></md-divider>
                                <!-- end ngIf: !$last -->
                            </md-list-item>
                        </md-card-content>
                    </md-card>
                    
                    <md-card ng-if="searchedFbPages.length > 0">
                        <md-card-content>
                            <h2 class="md-title">Searched Results</h2>
                            <md-list-item class="md-3-line md-no-proxy ng-scope" data-ng-repeat="page in searchedFbPages"
                                      role="listitem">
                                <button class="md-fab   md-button
                                    md-default-theme md-fab-md social-graph-fab" ng-click="viewPageDetails(page)"
                                         aria-label="button">
                                    <i class="ion-social-facebook-outline ion-30"></i>
                                </button>

                                <div class="md-list-item-text text-right">
                                    <h3 class="graph-h2">{{page.name}}</h3>
                                </div>
                                <!-- ngIf: !$last -->
                                <md-divider md-inset="" ng-if="!$last" class="ng-scope md-default-theme"></md-divider>
                                <!-- end ngIf: !$last -->
                            </md-list-item>
                        </md-card-content>
                    </md-card>

                </div>
            </md-content>

        </div>
    </div>

    <!-- graph -->
    <div ng-class="{'block' : !activePageSearch,'hidden' : activePageSearch}" id="fbGraph">
        <!-- Top Header -->
        <md-content class="md-default-theme overflow-none ">
            <div class="md-content__body">
                <div class="home-mini-card">
                    <div class="row m-t-0">
                        <div class="col-md-1">
                                <span class="circle-icon md bg-primary">
                                  <md-icon class="color-white ng-isolate-scope md-default-theme
                                  fa fa-facebook fa-3x"
                                           aria-hidden="true">
                                  </md-icon>
                                </span>
                        </div>
                        <div class="col-md-5">
                            <div class="graph-main-header-text">
                                <!-- social page name-->
                                <h2 class="color-primary graph-h1">
                                    <!-- digin{{page.name}}-->
                                    {{page.name}}
                                </h2>
                                <a href="https://www.facebook.com/{{page.id}}" target="_blank" class="small-text">
                                    Open in facebook
                                </a>
                            </div>

                            <div class="page-search-warp">
<!--
                                <div class="p-l-20 ">
                                    <a href="javascript:void(0)" data-ng-click="onFilterData()" class="inline-block">
                                        <small class="small-text">search page data</small>
                                        <i class="ti-search pull-right"></i>
                                    </a>
                                </div>
-->
<!--
                                <div layout="row">
                                   <div>
                                    <md-date-picker model="sinceDate" label="Since" dialog-md-theme="datePickerTheme"/>
                                   </div>
                                   <div>
                                    <md-date-picker model="untilDate" label="Until" dialog-md-theme="datePickerTheme"/>
                                   </div>
                                    <md-button class="md-primary" ng-click="changeTimeRange()">
                                       <i class="ti-search pull-right"></i>
                                    </md-button>
                                </div>
-->
                            </div>
                        </div>
                        <div class="col-md-6">
                           <div layout="row">
                                   <div>
                                    <md-date-picker model="sinceDate" label="Since" dialog-md-theme="datePickerTheme"/>
                                   </div>
                                   <div>
                                    <md-date-picker model="untilDate" label="Until" dialog-md-theme="datePickerTheme"/>
                                   </div>
                                    <md-button class="md-primary" ng-click="changeTimeRange()">
                                       <i class="ti-search pull-right"></i>
                                    </md-button>
                                </div>
                            <!-- posts -->
                        <!--    <ul class="list-justified text-center">
                                <li>
                                    <p class="size-h2 text-color-100 graph-h1">
                                        {{postCount}}
                                    </p>

                                    <p class="text-muted graph-h5">Posts</p>
                                </li>
                                <!-- commenters -->
                          <!--      <li>
                                    <p class="size-h2 text-color-100 graph-h1 font-weight-500">
                                        {{totalViews}}
                                    </p>

                                    <p class="text-muted graph-h5 font-weight-500">Views</p>
                                </li>
                                <!-- likes-->
                          <!--      <li class="last-icon">
                                    <p class="size-h2 text-color-100 graph-h1 font-weight-500">
                                        {{totalLikes}}
                                    </p>

                                    <p class="text-muted graph-h5">Likes</p>
                                </li>
                            </ul> -->
                        </div>
                        <div class="col-md-1">
                            <div class="back p-l-20" ng-click="goBack()">
                            <i class="ti-arrow-left fnt-s-24"></i>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </md-content>

        <div class="graph-main-wrap">
            <!-- body chart wrap -->
            <div class="graph-body">
                <div>
                  <md-card class="md-default-theme overflow-none fb-graph-bg">
                            <div class="graph-fb-wrap">
                                <div class="text-left col-sm-6">
                                    <h2 class="graph-h2">
                                        Sentiment Analysis
                                        <div class="md-card-toolbar-actions">
                                            <i class="md-icon-1 ti-view-list-alt"
                                               ng-click="onClickViewTable('sentiment')"
                                            ></i>
                                        </div>
                                    </h2>
                                </div>
                                <div class="graph-chart-body">
                                    <highchart id="fbChart" config="sentimentConfig"></highchart>
                                </div>
                            </div>
                        </md-card>
                </div>
                <div layout="row" layout-wrap>
                    <div flex="60">
                        <md-card class="md-default-theme overflow-none fb-graph-bg">
                            <div class="graph-fb-wrap">
                                <div class="text-left col-sm-6">
                                    <h2 class="graph-h2">
                                        Realtime performance feed
                                        <div class="md-card-toolbar-actions">
                                            <i class="md-icon-1 ti-view-list-alt"
                                               ng-click="onClickViewTable('realtime')"
                                            ></i>
                                        </div>
                                    </h2>
                                </div>
                                <div class="graph-chart-body">
                                    <highchart id="fbChart" config="highchartsNG"></highchart>
                                </div>
                            </div>
                        </md-card>
                    </div>
                    <div flex="40">
                        <md-card class="graph-map overflow-none fb-graph-bg">
                            <div class="graph-fb-wrap wrap-overflow ">
                                <div class="graph-map-content">
                                    <digin-map map-data="{{arrAdds}}"></digin-map>
                                </div>
                                <div class="text-left col-sm-6" layout-margin>
                                    <h2 class="graph-h2">
                                        Location
                                        <div class="md-card-toolbar-actions">
                                            <i class="md-icon-1 ti-view-list-alt"
                                               ng-click="onClickViewTable('map')"
                                            ></i>
                                        </div>
                                    </h2>

                                </div>
                            </div>
                        </md-card>
                    </div>
                </div>
                <div layout="row" layout-wrap>
                    <div flex="100">
                        <md-card class="md-default-theme overflow-none fb-graph-bg">
                            <div class="graph-fb-wrap">
                                <div class="text-left col-sm-6">
                                    <h2 class="graph-h2">
                                        Word Cloud
                                    </h2>
                                </div>
                                <digin-word-cloud words="wordArray"></digin-word-cloud>
                            </div>
                        </md-card>
                    </div>
                    
                </div>

                <!--wrap post details -->
                <div class="post-wrap">

                    <div layout="row" layout-wrap>
                        <div flex>
                            <div layout="row" layout-align="center center" layout-wrap>
                                <!-- Likes -->
                                <div flex="20">
                                    <md-card class="md-default-theme">
                                        <div class="md-content__body">
                                            <section class="home-mini-card">
                                                <div class="row">
                                                    <div class="col-md-4">
                                                    <span class="circle-icon md  bg-like m-l-10">
                                                  <i class="color-white  ti-thumb-up"
                                                     aria-hidden="true">
                                                  </i>
                                                 </span>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <h2 class=" graph-h1 color-accent">
                                                            {{totalLikes}}
                                                        </h2>

                                                        <p class="font-color-100">
                                                            likes
                                                        </p>
                                                    </div>
                                                </div>
                                            </section>
                                        </div>
                                    </md-card>
                                </div>

                                <div flex="20">
                                    <!-- shares -->
                                    <md-card class="md-default-theme">
                                        <div class="md-content__body">
                                            <section class="home-mini-card">
                                                <div class="row">
                                                    <div class="col-md-4">
                                                    <span class="circle-icon md  bg-like m-l-10">
                                                  <i class="color-white ti-eye"
                                                     aria-hidden="true">
                                                  </i>
                                                 </span>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <h2 class=" graph-h1 color-accent">
                                                            {{totalViews}}
                                                        </h2>

                                                        <p class="font-color-100">
                                                            Views
                                                        </p>
                                                    </div>
                                                </div>
                                            </section>
                                        </div>
                                    </md-card>
                                </div>

                                <div flex="20">
                                    <!-- comments -->
                                    <md-card class="md-default-theme">
                                        <div class="md-content__body">
                                            <section class="home-mini-card">
                                                <div class="row">
                                                    <div class="col-md-4">
                                                    <span class="circle-icon md  bg-like m-l-10">
                                                  <i class="color-white ti-comment"
                                                     aria-hidden="true">
                                                  </i>
                                                 </span>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <h2 class=" graph-h1 color-accent">
                                                             {{postCount}}
                                                        </h2>

                                                        <p class="font-color-100">
                                                            Posts
                                                        </p>
                                                    </div>
                                                </div>
                                            </section>
                                        </div>
                                    </md-card>
                                </div>

                                <div flex="20">
                                    <!-- average engagement per week -->
                                    <md-card class="md-default-theme">
                                        <div class="md-content__body">
                                            <section class="home-mini-card">
                                                <div class="row">
                                                    <div class="col-md-4">
                                                    <span class="circle-icon md  bg-like m-l-10">
                                                  <i class="color-white ti-comment"
                                                     aria-hidden="true">
                                                  </i>
                                                 </span>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <h2 class=" graph-h1 color-accent">
                                                             {{totalEngagement/engageLikes| number:2}}
                                                        </h2>

                                                        <p class="font-color-100">
                                                            Average Engagement Per Week
                                                        </p>
                                                    </div>
                                                </div>
                                            </section>
                                        </div>
                                    </md-card>
                                </div>

                                <div flex="20">
                                    <!-- total engagement this week -->
                                    <md-card class="md-default-theme">
                                        <div class="md-content__body">
                                            <section class="home-mini-card">
                                                <div class="row">
                                                    <div class="col-md-4">
                                                    <span class="circle-icon md  bg-like m-l-10">
                                                  <i class="color-white ti-comment"
                                                     aria-hidden="true">
                                                  </i>
                                                 </span>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <h2 class=" graph-h1 color-accent">
                                                             {{totalEngagement}}
                                                        </h2>

                                                        <p class="font-color-100">
                                                            Total Engagement This Week
                                                        </p>
                                                    </div>
                                                </div>
                                            </section>
                                        </div>
                                    </md-card>
                                </div>

                           </div>
                        </div>
                        <!-- Post types -->
                         
                    </div>
                </div>
                <div class="post-wrap">
                   <div layout="row" layout-wrap>
                       <div flex>
                           <div layout="row" layout-align="center center" layout-wrap>
                               <div flex="90">
                                   <md-card class="md-default-theme">
                                       <div class="md-content__body" layout-align="center center">
                                          <digin-word-cloud words="wordArray"></digin-word-cloud>
                                       </div>
                                   </md-card>
                               </div>
                           </div>
                       </div>        
                   </div>
               </div>   
            </div>

            <!-- Posts details-->
            <div class="fb-posts-wrap">
                <div layout="row" layout-wrap>
                    <div flex>
                        <md-card class="md-default-theme overflow-none">
                            <div class="graph-fb-wrap-post">
                                <div class="text-left col-sm-6">
                                    <h2 class="graph-h2">
                                        {{ chooseView.Post }}
                                    </h2>
                                </div>
                                <!-- view posts -->
                                <div class="post-view" data-ng-if="viewLayout.isPost">
                                    <table class="table table-border-none">
                                        <thead>
                                        <tr class="tbl-border-bottom">
                                            <td>
                                            </td>
                                            <td class="tbl-width-450">
                                                Content
                                            </td>
                                            <td>
                                                Likes
                                            </td>
                                            <td>
                                                Shares
                                            </td>
                                            <td>
                                                Comments
                                            </td>
                                            <td>
                                                Engagement
                                            </td>
                                            <td>
                                                Created
                                            </td>
                                            <td>
                                                Sentiment
                                            </td>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr data-ng-repeat="post in postsObj" ng-click="viewSinglePost(post)">
                                            <td>
                                                <div data-ng-if="post.image_url==null">
                                                    <i class="fa fa-link"></i>
                                                </div>
                                                <div data-ng-if="post.image_url!=null">
                                                    <i class="fa fa-camera"></i>
                                                </div>
                                            </td>
                                            <td>
                                                <code class="post-message">{{post.message}}</code>

                                                <div class="post-image">
                                                    <div data-ng-if="post.image_url==null">
                                                        {{post.url}}
                                                    </div>
                                                    <img class="post-image" style="width:80px;height:80px;" data-ng-src="{{post.picture}}">
                                                </div>
                                                <md-tooltip md-direction="bottom">{{post.message}}</md-tooltip>
                                            </td>
                                            <td>
                                               <code>{{post.likes}}</code>
                                            </td>
                                            <td>
                                                <code>{{post.shares}}</code>
                                            </td>
                                            <td>
                                                <code>{{post.comments}}</code>
                                            </td>
                                            <td>
                                                <code>{{post.comments+post.shares}}</code>
                                            </td>
                                            <td>
                                                <code ng-bind="post.created_time | date:'dd MMM yyyy'">{{post.created_time}}</code>
                                            </td>
                                            <td>
                                               <div layout="column" layout-align="center center">
                                                 <img class="sentiment-emoticon" ng-src="{{post.sentiment.ico}}">
                                                 <br>
                                                 <div>{{post.sentiment.pol}}</div>  
                                               </div>
                                                
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </md-card>
                    </div>
                </div>
            </div>


        </div>
    </div>
</div>